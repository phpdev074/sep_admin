import{r as s,j as e,E as ie,B as l,G as le,I as K,T as i,J as k,K as h,L as w,F as m,M,H as ce}from"./index-C1GhD1OK.js";import{C as de}from"./config-global-CsQpxj4K.js";function he(){const[g,V]=s.useState("settings");s.useState(!1),s.useState(void 0),s.useState("");const[u,E]=s.useState(""),[f,P]=s.useState(""),[_,I]=s.useState(""),[q,N]=s.useState(""),[Q,T]=s.useState(!0),[F,z]=s.useState(""),[B,W]=s.useState(!1),[c,$]=s.useState(""),[X,L]=s.useState(!1),[D,j]=s.useState(""),[H,Y]=s.useState(!1),[O,S]=s.useState(!1),[x,y]=s.useState(30),[p,v]=s.useState(5),[Z,b]=s.useState(30),[ee,A]=s.useState(5),[ae,R]=s.useState(!1),[U,G]=s.useState(!1),[J,C]=s.useState("");s.useEffect(()=>{(async()=>{var r,n,d;T(!0),z("");try{const o=localStorage.getItem("token");if(!o)throw new Error("No auth token found");const a=(r=(await m.get("/admin/getAdmin",{headers:{Authorization:`Bearer ${o}`}})).data)==null?void 0:r.data;E(a.name||""),P(a.email||""),I(a.name||""),N(a.email||""),y(a==null?void 0:a.commission),v(a==null?void 0:a.transactionCharge),b(a==null?void 0:a.commission),A(a==null?void 0:a.transactionCharge)}catch(o){z(((d=(n=o.response)==null?void 0:n.data)==null?void 0:d.message)||o.message||"Failed to load admin data")}finally{T(!1)}})()},[]),s.useEffect(()=>{g==="charges"&&(async()=>{var r,n,d;R(!0),C("");try{const o=localStorage.getItem("token");if(!o)throw new Error("No auth token found");const a=(r=(await m.get("/admin/getAdmin",{headers:{Authorization:`Bearer ${o}`}})).data)==null?void 0:r.data;y(a==null?void 0:a.commission),v(a==null?void 0:a.transactionCharge),b(a==null?void 0:a.commission),A(a==null?void 0:a.transactionCharge)}catch(o){C(((d=(n=o.response)==null?void 0:n.data)==null?void 0:d.message)||o.message||"Failed to load charges")}finally{R(!1)}})()},[g]);const se=(t,r)=>{V(r)},te=async()=>{var t,r;G(!0),C("");try{const n=localStorage.getItem("token");if(!n)throw new Error("No auth token found");await m.put("/admin/editAdmin",{commission:x,transactionCharge:p},{headers:{Authorization:`Bearer ${n}`}}),b(x),A(p)}catch(n){C(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.message)||n.message||"Failed to update charges")}finally{G(!1)}},ne=x!==Z||p!==ee,re=()=>e.jsxs(l,{sx:{width:400,p:3,borderRadius:2,boxShadow:2,backgroundColor:"#f9f9f9",display:"flex",flexDirection:"column",gap:3,marginLeft:"371px"},children:[e.jsx(i,{variant:"h6",mb:1,children:"Charges Settings"}),ae?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:100,children:e.jsx(k,{})}):J?e.jsx(i,{color:"error",children:J}):e.jsxs(e.Fragment,{children:[e.jsx(h,{label:"Commission Charge (%)",type:"number",inputProps:{min:0,max:100,step:.1},value:x,onChange:t=>y(parseFloat(t.target.value)),fullWidth:!0}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Commission charge applied on each transaction"}),e.jsx(h,{label:"Transaction Charge (%)",type:"number",inputProps:{min:0,max:100,step:.1},value:p,onChange:t=>v(parseFloat(t.target.value)),fullWidth:!0}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Transaction charge applied on each withdrawal"}),e.jsx(w,{variant:"contained",onClick:te,disabled:U||!ne,sx:{alignSelf:"flex-end",width:"350px"},children:U?"Saving...":"Save Charges"})]})]});return e.jsxs(ie,{children:[e.jsx(l,{sx:{width:"100%",mb:3},children:e.jsxs(le,{value:g,onChange:se,centered:!0,children:[e.jsx(K,{label:"Settings",value:"settings"}),e.jsx(K,{label:"Charges",value:"charges"})]})}),g==="settings"?e.jsx(l,{display:"flex",flexDirection:"column",alignItems:"center",mb:5,children:e.jsxs(l,{sx:{width:400,p:2,mb:4,borderRadius:2,boxShadow:2,backgroundColor:"#f9f9f9",display:"flex",flexDirection:"column",gap:2},children:[e.jsx(i,{variant:"h6",children:"Admin Info"}),Q?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:100,children:e.jsx(k,{})}):F?e.jsx(i,{color:"error",children:F}):e.jsxs(e.Fragment,{children:[e.jsx(h,{label:"Name",value:u,fullWidth:!0,onChange:t=>E(t.target.value)}),e.jsx(h,{label:"Email",value:f,fullWidth:!0,onChange:t=>P(t.target.value)}),(u!==_||f!==q)&&e.jsx(w,{variant:"contained",onClick:async()=>{var t,r;W(!0);try{const n=localStorage.getItem("token");if(!n)throw new Error("No auth token found");await m.put("/admin/editAdmin",{name:u,email:f},{headers:{Authorization:`Bearer ${n}`}}),I(u),N(f)}catch(n){alert(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.message)||n.message||"Failed to update admin info")}finally{W(!1)}},disabled:B,sx:{alignSelf:"flex-end",mt:1},children:B?"Saving...":"Save"}),e.jsx(i,{variant:"subtitle1",mt:3,children:"Change Password"}),e.jsx(h,{label:"New Password",type:H?"text":"password",value:c,onChange:t=>$(t.target.value),fullWidth:!0,size:"small",InputProps:{endAdornment:e.jsx(w,{onClick:()=>Y(t=>!t),size:"small",sx:{minWidth:"auto",ml:1},children:H?e.jsx(M,{icon:"eva:eye-off-fill",width:20}):e.jsx(M,{icon:"eva:eye-fill",width:20})})}}),D&&e.jsx(i,{color:"error",variant:"body2",children:D}),X&&e.jsx(i,{color:"success.main",variant:"body2",children:"Password updated successfully!"}),e.jsx(w,{variant:"contained",size:"small",sx:{mt:1},onClick:async()=>{var t,r;j(""),S(!0);try{const n=localStorage.getItem("token");if(!n)throw new Error("No auth token found");if(!c||c.length<6){j("Password must be at least 6 characters long."),S(!1);return}await m.put("/admin/editAdmin",{password:c},{headers:{Authorization:`Bearer ${n}`}}),L(!0),$(""),setTimeout(()=>L(!1),3e3)}catch(n){j(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.message)||n.message)}finally{S(!1)}},disabled:!c||O,children:O?e.jsx(k,{size:20,color:"inherit"}):"Update Password"})]})]})}):re()]})}function ue(){return e.jsxs(e.Fragment,{children:[e.jsx(ce,{children:e.jsxs("title",{children:[" ",`Blog - ${de.appName}`]})}),e.jsx(he,{})]})}export{ue as default};
